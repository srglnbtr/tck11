<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Today - TickClone</title>
  <link rel="stylesheet" href="style.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css"/>
  <style>
    .day-block { margin-bottom:20px; }
    .day-block h3 {
      margin: 10px 0; padding:6px 10px;
      background:#dbeafe; color:#1e40af;
      font-size:16px; font-weight:600;
      border-radius:6px;
    }
    .task {
      display:flex; justify-content:space-between; align-items:center;
      background:#f9fafb; border:1px solid #e5e7eb;
      border-radius:8px; padding:10px 12px; margin-top:8px;
      transition: background 0.2s;
    }
    .task:hover { background:#f3f4f6; }
    .task-info span { font-weight:500; color:#111827; }
    .task-info small { color:#6b7280; font-size:12px; }
    .task button {
      border:none; background:none; cursor:pointer;
      font-size:14px; color:#6b7280; transition: color 0.2s;
    }
    .task button:hover { color:#111827; }
    .task-list p { color:#9ca3af; text-align:center; margin-top:20px; }
  </style>
</head>
<body>
<script>
  if(localStorage.getItem('loggedIn')!=='true') location.href='login.html';
  function logout(){ localStorage.removeItem('loggedIn'); location.href='login.html'; }
</script>

<div class="app-layout">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div>
      <div class="logo"><i class="fas fa-thumbtack"></i> TickClone</div>
      <nav>
        <button onclick="location.href='calendar.html'"><i class="fas fa-calendar"></i> Calendar</button>
        <button class="active" onclick="location.href='today.html'"><i class="fas fa-calendar-day"></i> Today</button>
        <button onclick="location.href='next7days.html'"><i class="fas fa-calendar-week"></i> Next 7 Days</button>
        <button onclick="location.href='inbox.html'"><i class="fas fa-inbox"></i> Inbox</button>
        <hr/>
        <button onclick="location.href='work.html'"><i class="fas fa-briefcase"></i> Work</button>
        <button onclick="location.href='study.html'"><i class="fas fa-book"></i> Study</button>
        <button onclick="location.href='personal.html'"><i class="fas fa-user"></i> Personal</button>
      </nav>
    </div>
    <div class="bottom-actions">
      <button onclick="location.href='tasks.html'"><i class="fas fa-tasks"></i> Tasks</button>
      <button onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</button>
    </div>
  </aside>

  <!-- Main -->
  <main class="main-content">
    <div class="container">
      <div class="left" style="padding:20px; max-width:250px;">
        <div class="page-header"><h2>üìÖ Today</h2></div>
        <div class="info-box" style="margin-top:15px; color:#374151; font-size:14px; line-height:1.5;">
          <p>üëâ ”®–Ω”©”©–¥—Ä–∏–π–Ω –±“Ø—Ö –∞–∂–ª—É—É–¥ —ç–Ω–¥ —Ö–∞—Ä–∞–≥–¥–∞–Ω–∞.</p>
        </div>
      </div>
      <div class="right">
        <div id="taskList" class="task-list"></div>
      </div>
    </div>
  </main>
</div>

<script>
let tasks = JSON.parse(localStorage.getItem('tasks')) || [];
const taskList = document.getElementById('taskList');

function renderToday(){
  const now = new Date(); now.setHours(0,0,0,0);
  const list = tasks.filter(t=>{
    const d = new Date(t.date); d.setHours(0,0,0,0);
    return d.getTime() === now.getTime();
  });

  if(list.length===0){ taskList.innerHTML='<p>No tasks for today.</p>'; return; }

  const groups = {};
  list.forEach(t=>{
    const key = new Date(t.date).toDateString();
    if(!groups[key]) groups[key] = [];
    groups[key].push(t);
  });

  taskList.innerHTML = Object.keys(groups).map(dateStr=>{
    const dayTasks = groups[dateStr];
    const title = new Date(dayTasks[0].date)
      .toLocaleDateString(undefined,{weekday:'long', month:'short', day:'numeric'});
    return `
      <div class="day-block">
        <h3>${title}</h3>
        ${dayTasks.map(t=>`
          <div class="task">
            <div class="task-info">
              <span>${t.name}</span><br/>
              <small>${t.from||'All day'} ${t.to?'- '+t.to:''} ‚Ä¢ ${t.category}</small>
            </div>
            <div style="display:flex;gap:8px">
              <button onclick="edit('${t._id}')"><i class="fas fa-pen"></i></button>
              <button onclick="del('${t._id}')"><i class="fas fa-trash"></i></button>
            </div>
          </div>
        `).join('')}
      </div>
    `;
  }).join('');
}

function del(id){
  if(!confirm('Delete?')) return;
  tasks = tasks.filter(t=> t._id!==id);
  localStorage.setItem('tasks',JSON.stringify(tasks));
  renderToday();
}
function edit(id){
  const idx = tasks.findIndex(t=> t._id===id);
  if(idx===-1) return;
  const nt = prompt('Edit task name:', tasks[idx].name);
  if(nt && nt.trim()!==''){
    tasks[idx].name=nt.trim();
    localStorage.setItem('tasks',JSON.stringify(tasks));
    renderToday();
  }
}
renderToday();
</script>



</body>
</html>
